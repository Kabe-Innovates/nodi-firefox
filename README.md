# Focus Shield

Privacy-first Firefox MV3 extension that blocks distracting websites when inside a configured Productive Zone defined by geographic location and radius.

## Quick Start

```bash
npm install          # Install dependencies
npm run build        # Compile TypeScript
# Open about:debugging in Firefox/Zen → Load Temporary Add-on → Select manifest.json
```

## How It Works

1. **Set Location**: Click "Set Current Location as Work Zone" to save your GPS coordinates
2. **Add Domains**: List websites to block (e.g., youtube.com, reddit.com)
3. **Enable Monitoring**: Click "Save Settings" to activate blocking
4. **Get Focused**: Blocked sites won't load when you're within the configured radius (default: 50m)

The extension calculates your distance from the saved zone using GPS coordinates. If you're within the radius and try to access a blocked domain, you'll see a blocking page instead.

## Documentation

- **[QUICKSTART.md](QUICKSTART.md)** - 2-minute setup guide
- **[TESTING.md](TESTING.md)** - Step-by-step testing guide
- **[TROUBLESHOOTING.md](TROUBLESHOOTING.md)** - Fix common issues
- **[IMPLEMENTATION.md](IMPLEMENTATION.md)** - Technical deep dive
- **[CHANGES.md](CHANGES.md)** - What was fixed and why

## Features

✅ Geolocation-based website blocking  
✅ Configurable distance radius (1-10000 meters)  
✅ Custom blocklist per user  
✅ Persistent settings across sessions  
✅ Real-time distance tracking  
✅ Works offline (no external APIs)  
✅ Privacy-first (no telemetry)  

## Project Structure

```
manifest.json        Extension configuration (MV3)
webpack.config.js    Build configuration
tsconfig.json        TypeScript settings
package.json         Dependencies

src/
  background/        Service worker (blocking logic)
  popup/             Popup UI (user interface)
  options/           Options page (placeholder)
  content/           Content script (placeholder)
  common/utils.ts    Shared utilities (Haversine, storage)
  types/index.ts     TypeScript type definitions

public/
  popup.html         Popup template
  popup.css          Popup styling
  options.html       Options template
  options.css        Options styling

dist/                Compiled JavaScript (generated by webpack)
```

## Technology Stack

| Component | Technology |
|-----------|------------|
| Language | TypeScript ES2020 |
| Build Tool | Webpack 5 |
| Browser | Firefox 109+ / Zen Browser |
| Storage | browser.storage.local |
| Location | browser.geolocation API |
| Distance | Haversine formula |

## Building

```bash
# Install dependencies
npm install

# Development (watch mode if available)
npm run dev

# Production build
npm run build

# Type checking
npm run type-check

# Linting
npm run lint
```

## Loading in Browser

### Firefox

1. Open `about:debugging`
2. Click "This Firefox"
3. Click "Load Temporary Add-on..."
4. Select `manifest.json` from project root
5. Extension appears in toolbar

### Zen Browser

1. Open `about:debugging`
2. Click "This Zen"
3. Click "Load Temporary Add-on..."
4. Select `manifest.json` from project root
5. Extension appears in toolbar

## Testing

See **[TESTING.md](TESTING.md)** for comprehensive testing instructions.

Quick test:
1. Click extension icon → Set location → Grant permission
2. Add a domain (e.g., youtube.com)
3. Save settings → Status should show "Monitoring"
4. Visit the blocked domain → Should see blocking page

## Troubleshooting

See **[TROUBLESHOOTING.md](TROUBLESHOOTING.md)** for detailed solutions to common issues.

Quick checks:
- Status shows "Monitoring" (not "Idle")
- Location permission was granted
- Blocklist contains your domain
- You're within the configured radius
- Build succeeded: `npm run build`

## How Blocking Works

The extension monitors tab updates and performs these checks:

```
Tab starts loading
    ↓
Check if monitoring is enabled
    ↓
Check if domain is in blocklist
    ↓
Calculate distance from zone
    ↓
If distance ≤ radius → Block (redirect to blocking page)
If distance > radius → Allow (site loads normally)
```

## Permissions

| Permission | Purpose |
|-----------|---------|
| `geolocation` | Access user's GPS location |
| `storage` | Persist settings between sessions |
| `tabs` | Monitor and block website requests |

## Browser Compatibility

- Firefox 109+ (MV3)
- Zen Browser (based on Firefox)

Note: Chrome/Edge MV3 extensions use a different blocking mechanism and would require code changes.

## Future Enhancements

- Auto-update location
- Multiple zones support
- Time-based blocking (work hours only)
- Statistics and analytics
- Domain whitelist/exceptions
- Options page for persistent settings

## License

Unlicensed - Personal project

## Support

For issues or questions, check:
1. [TROUBLESHOOTING.md](TROUBLESHOOTING.md) - Detailed troubleshooting
2. [TESTING.md](TESTING.md) - Testing and verification
3. Browser console (F12) for error messages
4. [Firefox WebExtensions Docs](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions)
